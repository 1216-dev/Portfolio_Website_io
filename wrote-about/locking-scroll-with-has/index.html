<!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Locking scroll with :has() - Robb Owen</title><meta name="description" content="Now that :has has landed in all browsers, here's a quick tip for handling locked scroll"><meta name="theme-color" content="#ffab27"><meta name="color-scheme" content="only light"><link rel="apple-touch-icon" sizes="180x180" href="../../assets/img/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../../assets/img/favicon-16x16.png"><link rel="icon" type="image/png" href="../../assets/img/favicon.ico"><link href="https://front-end.social/@robb" rel="me"><meta property="og:site_name" content="Robb Owen Digital"><meta property="og:type" content="website"><meta property="og:locale" content="en_gb"><meta property="og:url" content="https://robbowen.digital/wrote-about/locking-scroll-with-has/"><meta property="og:title" content="Locking scroll with :has() - Robb Owen "><meta property="og:description" content="Now that :has has landed in all browsers, here's a quick tip for handling locked scroll"><meta property="og:image" content="https://robbowen.digital/assets/img/cards/locking-scroll-with-has.png"><meta name="twitter:image" content="https://robbowen.digital/assets/img/cards/locking-scroll-with-has.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@Robb0wen"><link href="../../feed.xml" rel="alternate" type="application/rss+xml" title="RSS Feed"><script>document.querySelector('html').classList.add('js');
    document.querySelector('html').classList.remove('no-js');</script><link href="https://fonts.googleapis.com/css?family=Bitter:400,700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="../../assets/css/styles.css"><style id="theme">:root{--bg:#f9f7f2;--line:#765de5;--fill:#ffab27;--text:#0f0f0f;--subtext:#eb524b;--duo:#d7a1ed}.stripes{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 22.93 22.93'%3E%3Cpolygon fill='%23ffab27' points='0 8.18 14.75 22.93 22.74 22.93 0 0.19 0 8.18'/%3E%3Cpolygon fill='%23ffab27' points='22.93 8.37 22.93 0.38 22.56 0 14.56 0 22.93 8.37'/%3E%3C/svg%3E");background-size:11px;opacity:.6}.dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 22.9 22.9' style='enable-background:new 0 0 22.9 22.9;' xml:space='preserve'%3E%3Ccircle fill='%23ffab27' class='st0' cx='5.7' cy='5.9' r='3'/%3E%3Ccircle fill='%23ffab27' class='st0' cx='17.2' cy='17.2' r='3'/%3E%3C/svg%3E%0A");background-size:12px}</style></head><body><a class="skip-link u-vhide" href="index.html#main-content">Skip to content</a><div class="loading loading--in"><div class="loading__mask"></div><div class="loader"><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div></div></div><div class="pagewrap"><div class="mainnav"><div class="logo-wrap"><a href="../../index.html"><span class="u-vhide">Back to the homepage</span> <span class="logo js-logo"><div class="logo__sugarloaf"><div class="shade" data-drift="-5 -10"><svg version="1.1" x="0px" y="0px" viewBox="0 0 256 256"><polygon class="filled-poly" points="137.6,67.7 38.5,193 236.8,193 "></polygon></svg></div><div class="logo"><svg version="1.1" x="0px" y="0px" viewBox="0 0 256 256"><polygon class="stroke-poly" points="105.2,79.7 28.2,177 182.2,177 "></polygon><polygon class="stroke-poly" points="127.6,51.7 28.5,177 226.8,177 "></polygon></svg></div></div></span></a></div><div class="menu-link"><button class="menu-link__trigger js-menu-trigger" aria-expanded="false" aria-controls="main-menu"><span class="menu-link__mask"><span class="menu-link__label menu-link__label--close js-menu-label-close" aria-hidden="true">Close</span> <span class="menu-link__label menu-link__label--open js-menu-label-open" aria-hidden="false">Menu</span></span></button></div><a class="hire-me" href="mailto:hello@robbowen.digital?subject=ðŸ¤˜ Hi Robb, I'd like to hire you"><div class="shade" data-drift="-4 -6" data-drift-center="y"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><path class="filled-path" d="M30.78,9.87c13.52,0,24.46,9.58,24.46,21.41a19.4,19.4,0,0,1-5,12.95h0l2.9,9.82L42.37,50.1h0a27.51,27.51,0,0,1-11.59,2.58,26.84,26.84,0,0,1-14-3.86C10.42,45,6.24,38.52,6.24,31.2,6.24,19.53,17.26,9.87,30.78,9.87Z"></path></svg></div><div class="main"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><path class="stroke-path" d="M27.78,5.87c13.52,0,24.46,9.58,24.46,21.41a19.4,19.4,0,0,1-5,12.95h0l2.9,9.82L39.37,46.1h0a27.51,27.51,0,0,1-11.59,2.58,26.84,26.84,0,0,1-14-3.86C7.42,41,3.24,34.52,3.24,27.2,3.24,15.53,14.26,5.87,27.78,5.87Z"></path></svg></div>Hire me</a></div><div class="main-menu js-menu" id="main-menu"><div class="main-menu__mask"></div><div class="main-menu__flyout"><div class="main-menu__inr wrap"><ul class="social-links"><li class="social-links__item"><a class="social-links__link social-links__link--ma" href="https://front-end.social/@Robb" rel="noopener noreferrer" target="_blank">Follow me on Mastodon</a></li><li class="social-links__item"><a class="social-links__link social-links__link--in" href="http://www.instagram.com/robb0wen" rel="noopener noreferrer" target="_blank">Follow me on Instagram</a></li><li class="social-links__item"><a class="social-links__link social-links__link--gh" href="https://github.com/robb0wen" rel="noopener noreferrer" target="_blank">Visit my GitHub</a></li><li class="social-links__item"><a class="social-links__link social-links__link--rss" href="../../feed.xml" rel="noopener noreferrer" target="_blank" data-rekishi-skip="">Subscribe to my RSS feed</a></li><li class="social-links__item"><a class="social-links__link social-links__link--email" href="mailto:hello@robbowen.digital" rel="noopener noreferrer" target="_blank">Send me an Email</a></li></ul><ul class="main-menu__links primary-links"><li class="primary-links__item"><a aria-current="page" class="primary-links__link t-primary" href="../../index.html" aria-describedby="desc_home">Home</a> <span id="desc_home" class="primary-links__summary">Back to the home page.</span></li><li class="primary-links__item"><a aria-current="page" class="primary-links__link t-primary" href="../../work" aria-describedby="desc_work">Work</a> <span id="desc_work" class="primary-links__summary">My approach to development.</span></li><li class="primary-links__item"><a class="primary-links__link t-primary" href="../../about" aria-describedby="desc_about">About</a> <span id="desc_about" class="primary-links__summary">A little about me and my background.</span></li><li class="primary-links__item"><a class="primary-links__link t-primary" href="../../writing" aria-describedby="desc_writing">Writing</a> <span id="desc_writing" class="primary-links__summary">My latest writing on tech and language.</span></li></ul></div></div></div><main id="main-content" class="page-body" tabindex="-1"><svg style="position:absolute;top:-900px;left:-900px;clip:rect(0,0,0,0)"><filter id="duotone_filter"><feColorMatrix type="matrix" result="grayscale" values="1 0 0 0 0
                  1 0 0 0 0
                  1 0 0 0 0
                  0 0 0 1 0"></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB" result="duotone"><feFuncR type="table" tableValues="0.3058823529411765 0.9490196078431372"></feFuncR><feFuncG type="table" tableValues="-0.07058823529411765 0.7137254901960784"></feFuncG><feFuncB type="table" tableValues="0.4588235294117647 1.0431372549019609"></feFuncB><feFuncA type="table" tableValues="0 1"></feFuncA></feComponentTransfer></filter></svg><div class="article" data-reveal="is-onscreen"><div><div class="article-heading"><span class="article-heading__byline">20th December 2023</span><h1 class="article-heading__title t-heading t-medium:s t-big:m t-bigger:l"><span>Locking scroll with :has()<span class="dot">.</span></span></h1></div></div><div class="article__content flow reveal-content"><p>It's finally happened â€“ with the <a href="https://www.mozilla.org/en-US/firefox/121.0/releasenotes/" target="_blank">release of Firefox 121.0</a> <code>:has()</code> has landed in all browsers (though writing "<code>:has()</code> has" is sadly no less awkward). In celebration, I thought it a good time to share one of my favourite practical uses of <code>:has()</code> so far â€“ scroll locks.</p><p>Imagine that you need to open a modal window, or flyout menu. To prevent from losing the user's place in the page whilst that modal is open â€“ particularly on mobile devices â€“ it's good practice to prevent the page behind it from scrolling. That's a scroll lock.</p><p>Let's take a look at how we might implement one.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="locking-scroll">Locking scroll<span class="dot">.</span><a href="index.html#locking-scroll" class="u-vhide"> permalink</a></h2><p>Probably the simplest way to lock the user from scrolling a document is to add <code>overflow: hidden</code> to the document body.</p><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">body.lock-scroll</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>This class will totally disable scrolling, so we can't just leave it in our HTML. It will need to be conditionally added and removed whenever a modal, flyout or scroll-locking element is active within the page.</p><p>One way to solve this might be to adjust the body class when opening or closing the scroll-locking element:</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">openModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// ...some code to open the modal</span></span><br><span class="highlight-line">  <span class="token comment">// then lock the scroll</span></span><br><span class="highlight-line">  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'lock-scroll'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">closeModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// ...some code to close the modal</span></span><br><span class="highlight-line">  <span class="token comment">// then unlock the scroll</span></span><br><span class="highlight-line">  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'lock-scroll'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>This method is generally fine, but there are some complications.</p><p>What happens if you have multiple screen locks at the same time, for example? Let's say that our user clicks a hamburger menu to open a flyout whilst a modal is already open; both UI elements will lock the scrolling but, using the approach above, closing either the modal or the flyout would remove the <code>.lock-scroll</code> class from the body and unlock the scrolling whilst the other element is still active.</p><p>Similarly, if you're in a framework with clientside routing then navigating to a different page won't automatically remove the body class. Unfortunately, that means the scroll will still locked when the new page is loaded in.</p><p>None of this is insurmountable by any means, but managing the body class to cope with edge-cases takes a bit of effort. CSS can make things simpler.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="solving-edge-cases-with-has">Solving edge-cases with <code>:has()</code><span class="dot">.</span><a href="index.html#solving-edge-cases-with-has" class="u-vhide"> permalink</a></h2><p>Because <code>:has()</code> lets us modify a parent element based on its contents, handling scroll locks becomes a breeze. We can tweak the CSS declaration on our body element to use <code>:has()</code>:</p><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">body:has(.lock-scroll)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Now, rather than managing state directly on the body by toggling a <code>.lock-scroll</code> class with Javascript, we can now manage it on the markup of any element that needs to lock the page scroll:</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dialog</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lock-scroll<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line"><span class="token comment">&lt;!-- some wonderful modal content --&gt;</span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dialog</span><span class="token punctuation">&gt;</span></span></span></code></pre><p>Instead of the lock being hinged on JS state-management, we've tied it to the contents of the DOM itself. <strong>As long an element with <code>.lock-scroll</code> is in the DOM, the scroll we be locked</strong>.</p><p>Need to unlock the scroll? remove the element from the DOM. If there are multiple instances of <code>.lock-scroll</code>, then the scroll will <em>remain locked until all of them are gone</em>. The same goes for route changes - if there's no <code>.lock-scroll</code> class present in the new page then the scrolling will be automatically unlocked.</p><p>...and that's kinda all there is to it. Lush.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="wrapping-up">Wrapping up<span class="dot">.</span><a href="index.html#wrapping-up" class="u-vhide"> permalink</a></h2><p>The above is a very simple example, but it's one that I've found useful. With support for <code>:has()</code> now across all browsers, it's also one that is increasingly viable. The nature of CSS means it's pretty simple to expand the example to more elabourate use-cases too. You might, for example, wish to bind the scroll lock as a side-effect to changes in data or aria attributes:</p><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">body:has(.some-class[aria-expanded="true"])</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Whatever your application, <code>:has()</code> looks to be a really handy tool and I'm stoked to see it finally get full support.</p></div><footer class="article__footer"><div class="author"><div class="author__inr"><div class="author__portrait"><div class="portrait"><span class="portrait__bg dots" data-drift="-10 -10"></span><div class="portrait__image"><span class="duotone"><img src="../../assets/img/portrait_small.jpg"></span></div></div></div><div class="author__bio flow"><h4 class="t-heading t-sublede:s t-lede:m t-medium:l">Hi, my name is Robb<span class="dot">.</span></h4><p>I'm a freelance creative developer helping awesome people to build ambitious yet accessible web projects.</p><a href="mailto:hello@robbowen.digital?subject=ðŸ¤˜ Hi Robb, I'd like to hire you" class="btn author__cta"><span class="btn__label">Hire me</span> <span class="btn__fill stripes" data-drift="-10 -12" aria-hidden="true">Hire me</span></a></div></div></div></footer></div></main><small class="made-in-wales">Â© MMXXIV. Gwneud yn Ne Cymru.</small></div><script src="../../assets/js/main.js"></script></body></html>