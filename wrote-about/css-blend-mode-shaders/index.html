<!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Holograms, light-leaks and how to build CSS-only shaders - Robb Owen</title><meta name="description" content="Get a shiny WebGL look without actually using WebGL. In this article we take a look at how CSS blend modes unleash the potential of cool compositing effects without the need for JavaScript"><meta name="theme-color" content="#69ecc6"><meta name="color-scheme" content="only light"><link rel="apple-touch-icon" sizes="180x180" href="../../assets/img/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../../assets/img/favicon-16x16.png"><link rel="icon" type="image/png" href="../../assets/img/favicon.ico"><link href="https://front-end.social/@robb" rel="me"><meta property="og:site_name" content="Robb Owen Digital"><meta property="og:type" content="website"><meta property="og:locale" content="en_gb"><meta property="og:url" content="https://robbowen.digital/wrote-about/css-blend-mode-shaders/"><meta property="og:title" content="Holograms, light-leaks and how to build CSS-only shaders - Robb Owen "><meta property="og:description" content="Get a shiny WebGL look without actually using WebGL. In this article we take a look at how CSS blend modes unleash the potential of cool compositing effects without the need for JavaScript"><meta property="og:image" content="https://robbowen.digital/assets/img/cards/css-blend-mode-shaders.png"><meta name="twitter:image" content="https://robbowen.digital/assets/img/cards/css-blend-mode-shaders.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@Robb0wen"><link href="../../feed.xml" rel="alternate" type="application/rss+xml" title="RSS Feed"><script>document.querySelector('html').classList.add('js');
    document.querySelector('html').classList.remove('no-js');</script><link href="https://fonts.googleapis.com/css?family=Bitter:400,700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="../../assets/css/styles.css"><style id="theme">:root{--bg:#f9f6f9;--line:#6000cb;--fill:#69ecc6;--text:#0a094a;--subtext:#2229aa;--duo:#91d8c4}.stripes{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 22.93 22.93'%3E%3Cpolygon fill='%2369ecc6' points='0 8.18 14.75 22.93 22.74 22.93 0 0.19 0 8.18'/%3E%3Cpolygon fill='%2369ecc6' points='22.93 8.37 22.93 0.38 22.56 0 14.56 0 22.93 8.37'/%3E%3C/svg%3E");background-size:11px;opacity:.6}.dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 22.9 22.9' style='enable-background:new 0 0 22.9 22.9;' xml:space='preserve'%3E%3Ccircle fill='%2369ecc6' class='st0' cx='5.7' cy='5.9' r='3'/%3E%3Ccircle fill='%2369ecc6' class='st0' cx='17.2' cy='17.2' r='3'/%3E%3C/svg%3E%0A");background-size:12px}</style></head><body><a class="skip-link u-vhide" href="index.html#main-content">Skip to content</a><div class="loading loading--in"><div class="loading__mask"></div><div class="loader"><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div></div></div><div class="pagewrap"><div class="mainnav"><div class="logo-wrap"><a href="../../index.html"><span class="u-vhide">Back to the homepage</span> <span class="logo js-logo"><div class="logo__skirrid"><div class="shade" data-drift="-5 -10"><svg version="1.1" x="0px" y="0px" viewBox="0 0 256 256"><polygon class="filled-poly" points="156.2,91.5 112.7,146.5 89,116.5 33.2,187 80.7,187 144.8,187 231.8,187"></polygon></svg></div><div class="logo"><svg version="1.1" x="0px" y="0px" viewBox="0 0 256 256"><polygon class="stroke-poly" points="84,106.5 28.2,177 139.8,177 "></polygon><polygon class="stroke-poly" points="151.2,81.5 75.7,177 226.8,177 "></polygon></svg></div></div></span></a></div><div class="menu-link"><button class="menu-link__trigger js-menu-trigger" aria-expanded="false" aria-controls="main-menu"><span class="menu-link__mask"><span class="menu-link__label menu-link__label--close js-menu-label-close" aria-hidden="true">Close</span> <span class="menu-link__label menu-link__label--open js-menu-label-open" aria-hidden="false">Menu</span></span></button></div><a class="hire-me" href="mailto:hello@robbowen.digital?subject=ðŸ¤˜ Hi Robb, I'd like to hire you"><div class="shade" data-drift="-4 -6" data-drift-center="y"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><path class="filled-path" d="M30.78,9.87c13.52,0,24.46,9.58,24.46,21.41a19.4,19.4,0,0,1-5,12.95h0l2.9,9.82L42.37,50.1h0a27.51,27.51,0,0,1-11.59,2.58,26.84,26.84,0,0,1-14-3.86C10.42,45,6.24,38.52,6.24,31.2,6.24,19.53,17.26,9.87,30.78,9.87Z"></path></svg></div><div class="main"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><path class="stroke-path" d="M27.78,5.87c13.52,0,24.46,9.58,24.46,21.41a19.4,19.4,0,0,1-5,12.95h0l2.9,9.82L39.37,46.1h0a27.51,27.51,0,0,1-11.59,2.58,26.84,26.84,0,0,1-14-3.86C7.42,41,3.24,34.52,3.24,27.2,3.24,15.53,14.26,5.87,27.78,5.87Z"></path></svg></div>Hire me</a></div><div class="main-menu js-menu" id="main-menu"><div class="main-menu__mask"></div><div class="main-menu__flyout"><div class="main-menu__inr wrap"><ul class="social-links"><li class="social-links__item"><a class="social-links__link social-links__link--ma" href="https://front-end.social/@Robb" rel="noopener noreferrer" target="_blank">Follow me on Mastodon</a></li><li class="social-links__item"><a class="social-links__link social-links__link--in" href="http://www.instagram.com/robb0wen" rel="noopener noreferrer" target="_blank">Follow me on Instagram</a></li><li class="social-links__item"><a class="social-links__link social-links__link--gh" href="https://github.com/robb0wen" rel="noopener noreferrer" target="_blank">Visit my GitHub</a></li><li class="social-links__item"><a class="social-links__link social-links__link--rss" href="../../feed.xml" rel="noopener noreferrer" target="_blank" data-rekishi-skip="">Subscribe to my RSS feed</a></li><li class="social-links__item"><a class="social-links__link social-links__link--email" href="mailto:hello@robbowen.digital" rel="noopener noreferrer" target="_blank">Send me an Email</a></li></ul><ul class="main-menu__links primary-links"><li class="primary-links__item"><a aria-current="page" class="primary-links__link t-primary" href="../../index.html" aria-describedby="desc_home">Home</a> <span id="desc_home" class="primary-links__summary">Back to the home page.</span></li><li class="primary-links__item"><a aria-current="page" class="primary-links__link t-primary" href="../../work" aria-describedby="desc_work">Work</a> <span id="desc_work" class="primary-links__summary">My approach to development.</span></li><li class="primary-links__item"><a class="primary-links__link t-primary" href="../../about" aria-describedby="desc_about">About</a> <span id="desc_about" class="primary-links__summary">A little about me and my background.</span></li><li class="primary-links__item"><a class="primary-links__link t-primary" href="../../writing" aria-describedby="desc_writing">Writing</a> <span id="desc_writing" class="primary-links__summary">My latest writing on tech and language.</span></li></ul></div></div></div><main id="main-content" class="page-body" tabindex="-1"><svg style="position:absolute;top:-900px;left:-900px;clip:rect(0,0,0,0)"><filter id="duotone_filter"><feColorMatrix type="matrix" result="grayscale" values="1 0 0 0 0
                  1 0 0 0 0
                  1 0 0 0 0
                  0 0 0 1 0"></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB" result="duotone"><feFuncR type="table" tableValues="0.00784313725490196 0.6039215686274509"></feFuncR><feFuncG type="table" tableValues="0.34509803921568627 0.9921568627450981"></feFuncG><feFuncB type="table" tableValues="0.25098039215686274 0.8823529411764706"></feFuncB><feFuncA type="table" tableValues="0 1"></feFuncA></feComponentTransfer></filter></svg><div class="article" data-reveal="is-onscreen"><div><div class="article-heading"><span class="article-heading__byline">7th July 2022</span><h1 class="article-heading__title t-heading t-medium:s t-big:m t-bigger:l"><span>Holograms, light-leaks and how to build CSS-only shaders<span class="dot">.</span></span></h1></div></div><div class="article__content flow reveal-content"><style>.spec-example{margin:50px 0;display:flex;justify-content:space-between;gap:2.5rem}.spec-example__fixed,.spec-example__static{flex:1;border:20px solid #fff;height:30rem;background-image:linear-gradient(to bottom,#000 20%,#3c5e6d 35%,#f4310e,#f58308 80%,#000)}@media (max-width:512px){.spec-example__fixed,.spec-example__static{border-width:10px}}.spec-example__fixed{background-attachment:fixed}.frame{position:relative;margin:25px auto;max-width:830px;border:20px solid #fff;background:#000}@media (max-width:512px){.frame{border-width:10px}}.frame img{display:block;width:100%;max-width:790px;height:auto;margin:0}.shader{backface-visibility:hidden;position:relative;display:block;overflow:hidden}.shader.is-waiting .shader__layer,.shader.is-waiting .shader__layer::after,.shader.is-waiting .shader__layer::before{display:none}.mask,.mask::after,.mask::before,.specular,.specular::after{background-color:#000;position:absolute;left:0;top:0;width:100%;height:100%;backface-visibility:hidden}.specular{background-color:#000;mix-blend-mode:color-dodge;background-attachment:fixed}.frame--asakusa .specular{z-index:0;background-color:#000;background-position:center;background-size:cover;mix-blend-mode:color-dodge;background-attachment:fixed;background-image:linear-gradient(to bottom,#000 20%,#3c5e6d 35%,#f4310e,#f58308 80%,#000)}.frame--asakusa .mask{z-index:1;background:#fff;background-size:100%;mix-blend-mode:multiply;background-image:linear-gradient(180deg,rgba(0,0,0,.2),rgba(0,0,0,.2)),url(../../assets/img/articles/holo/tower_spec.jpg)}.frame--sticker .specular{z-index:0;background-position:top center;background-image:linear-gradient(125deg,#f09 30%,#fc8b00,#ff0,#00ff8a,#00cfff,#cc4cfa 70%)}.frame--sticker .mask{background-repeat:no-repeat;background-size:45%;background-position:center;z-index:1;mix-blend-mode:multiply;background-image:url(../../assets/img/articles/holo/hologram.png)}.frame--sticker .mask::after{content:'';background-position:center;background-attachment:fixed;z-index:1;mix-blend-mode:color-burn;background-image:linear-gradient(45deg,#333 40%,#ddd 60%,#333)}.frame--leak .specular{z-index:0;mix-blend-mode:color-dodge;background-color:#000;background-position:top center;background-repeat:no-repeat;mix-blend-mode:color-dodge;background-attachment:fixed;background-image:linear-gradient(179deg,#000 40%,red,orange,#fff 60%,#000 80%)}.frame--leak .mask{mix-blend-mode:multiply;background-color:#fff;background-size:cover;background-image:url(../../assets/img/articles/holo/pinelake_mask.jpg)}.frame--aurora .specular{z-index:0;background-color:#000;background-position:center;background-size:100% 80%;mix-blend-mode:screen;background-attachment:fixed;background-image:linear-gradient(180deg,#3fd351,#08f,#8000ff,#08f,#3fd351)}.frame--aurora .mask{z-index:1;background:#fff;background-size:cover;mix-blend-mode:multiply;background-image:linear-gradient(to bottom,rgba(0,0,0,.25) 15%,transparent),url(../../assets/img/articles/holo/forest_spec.jpg)}.blend-example{margin:50px 0;box-sizing:content-box;border:20px solid #fff;height:min(352px,45vw);display:grid;grid-template-columns:repeat(var(--cols,2),1fr);grid-template-rows:1fr}@media (max-width:512px){.blend-example{border-width:10px}}.blend-example__col{position:relative}.blend-example__col img{width:100%;height:min(352px,45vw);object-fit:cover}.blend-example__layer{position:absolute;top:0;left:0;width:100%;height:100%;mix-blend-mode:var(--blend);filter:brightness(.99)}.example{margin:50px 0}.example--mask .mask,.example--mask .specular,.example--spec .specular,.example--specmask .specular{mix-blend-mode:normal}.example--off .specular,.example--spec .specular .mask,.example--specbase .mask{display:none}</style><p>I might be understating it a bit, but WebGL is a big deal. You only need to spend five minutes on one of the many design awards sites to see site-after-site fully leaning into the power of <code>canvas</code>. Tools like <a href="https://threejs.org/" target="_blank">threejs</a> make it easier to harness the power of 3D and <abbr title="OpenGL Shading Language">GLSL</abbr> shaders and, with that, a whole new level of visual effects.</p><p>This got me thinking though; why let JS have all the fun? With <code>mix-blend-mode</code> finally gaining wide browser-support, we now have access to many of most common shading techniques in CSS. With some choice images and a bit of careful layering it's possible to build some surprisingly high-quality effects without the need for introducing any JS dependencies.</p><p>Let's take a look at an example. As you scroll past the image below, the sunlight blooms a warm orange, before fading to a cool blue. You'll also briefly see some lens bokeh.</p><div class="frame frame--asakusa"><div class="shader"><img src="../../assets/img/articles/holo/tower.jpg" alt="Asakusa at dusk"><div class="shader__layer specular"><div class="shader__layer mask"></div></div></div></div><p>Ooooh shiny. Let's break it down.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="what-is-a-css-shader">What is a CSS 'shader'?<a href="index.html#what-is-a-css-shader" class="u-vhide"> permalink</a></h2><p>Shaders in the WebGL world are complex GLSL scripts that determine how each individual pixel is rendered to the screen. We still don't have <em>that</em> level of control in our CSS so, at its most basic level, our CSS 'shader' is just an image with additional background-image layers above it. Yes, I'm taking a few liberties with the name but with careful use of gradients, masking, nesting and <code>mix-blend-mode</code> we can manage how these layers interact with both one-another and the image at the bottom of the stack.</p><p>For the sake of visualising this core structure, the 'shader' example above is set up with a few nested divs:</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tower.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Asakusa at dusk<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer specular<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer mask<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span></code></pre><p>To keep each layer aligned with the image at the base, we keep the nested content positioned with the following CSS:</p><pre class="language-css"><code class="language-css"><span class="highlight-line">  <span class="token selector">.shader</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token comment">/* to force GPU performance. More on that later */</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token selector">.shader__layer</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-size</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span></code></pre><p>Ok, with the basic layout taken care of, lets take a look at the first layer of our effect - the lighting.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="simulating-specularity">Simulating specularity<span class="dot">.</span><a href="index.html#simulating-specularity" class="u-vhide"> permalink</a></h2><p>First of all we need to think about how light travels from light to dark across the surface of our image. We'll need an area of brightness where the light is at its most intense, falling off gradually into darkness as the light dissipates. We'll do this with a gradient.</p><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">.specular</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>180deg<span class="token punctuation">,</span> black 20%<span class="token punctuation">,</span> #3c5e6d 35%<span class="token punctuation">,</span> #f4310e<span class="token punctuation">,</span> #f58308 80%<span class="token punctuation">,</span> black<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>If you imagine looking at a shiny surface, the light that reflects back is known as a specular reflection. How and where that highlight appears is dependant on the light source, but also your viewing angle - the highlight moves with you. Whilst our gradient is looking lovely, it's all a bit static. We'll need to introduce a bit of movement to really sell the effect.</p><p>Fortunately, there's a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background-attachment" target="_blank">vintage CSS Level 1 property</a> that can help with that; setting <code>.specular</code> to <code>background-attachment: fixed</code> means that, as the page scrolls, the gradient remains locked to the browser's viewport. This not only brings some much needed motion to our shader, but also means that we can very roughly simulate the changing view-angle without reaching for JavaScript.</p><div class="spec-example"><div class="spec-example__static"></div><div class="spec-example__fixed"></div></div><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">.specular</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">background-attachment</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>180deg<span class="token punctuation">,</span> black 20%<span class="token punctuation">,</span> #3c5e6d 35%<span class="token punctuation">,</span> #f4310e<span class="token punctuation">,</span> #f58308 80%<span class="token punctuation">,</span> black<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Great! Now, let's get to applying this lighting to our base image.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="know-your-blend-modes">Know your blend modes<span class="dot">.</span><a href="index.html#know-your-blend-modes" class="u-vhide"> permalink</a></h2><p>As the name implies, <code>mix-blend-mode</code> mixes the colours of each pixel in one element layer together with the layer directly below it. As with GLSL, CSS gives us a nice <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/blend-mode" target="_blank">long list of options to choose from</a>, and creating the right effect means knowing which blend is going to give the results we need. But what do these blend modes actually do? Before we get stuck in with our shader, let's take a quick look at the blend modes we'll be using.</p><p>Below you can see the images that we'll be using for these examples. On the left is the upper layer to be blended, and the right is the base image we'll be blending onto.</p><div class="blend-example"><div class="blend-example__col"><img src="../../assets/img/articles/holo/mask-layer.jpg" alt="Black and white concentric circles, with two grey semi-circles at the centre"></div><div class="blend-example__col"><img src="../../assets/img/about/lakebled.jpg" alt="Lake bled from above"></div></div><p>First off, let's look at a <code>multiply</code> blend. <code>Multiply</code> takes the colour of each pixel in the current layer and multiplies it with the colour of the pixel directly beneath it. In practice this means that <em>darker colours in the current layer will obscure those in the layer below</em>:</p><div class="blend-example" style="--cols:1"><div class="blend-example__col"><img src="../../assets/img/about/lakebled.jpg" alt="Lake bled from above"><div class="blend-example__layer" style="--blend:multiply"><img src="../../assets/img/articles/holo/mask-layer.jpg" alt="Black and white concentric circles, with two grey semi-circles at the centre"></div></div></div><p>Setting the blend to <code>screen</code> takes the inverse of each pixel and multiplies them before inverting the result. This might sound complicated, but you can think of <code>screen</code> as the opposite of <code>multiply</code> - <em>Darker colours become transparent and only the lighter colours will show through to the layer below</em>:</p><div class="blend-example" style="--cols:1"><div class="blend-example__col"><img src="../../assets/img/about/lakebled.jpg" alt="Lake bled from above"><div class="blend-example__layer" style="--blend:screen"><img src="../../assets/img/articles/holo/mask-layer.jpg" alt="Black and white concentric circles, with two grey semi-circles at the centre"></div></div></div><p>Lastly, <code>color-dodge</code> and <code>color-burn</code> are like taking <code>multiply</code> and <code>screen</code> into overdrive. Both modes divide the pixel colour on the base layer with the one in the current layer.</p><p><em>For <code>color-dodge</code> this means that highlights and midtones get blown out whilst dark tones have no affect at all. <code>color-burn</code> will boost shadows and darker midtones, whilst lighter tones have no affect at all</em>.</p><p>In the image below, the left example is <code>color-dodge</code> and the right is <code>color-burn</code>.</p><div class="blend-example" style="--cols:2"><div class="blend-example__col"><img src="../../assets/img/about/lakebled.jpg" alt="Lake bled from above"><div class="blend-example__layer" style="--blend:color-burn"><img src="../../assets/img/articles/holo/mask-layer.jpg" alt="Black and white concentric circles, with two grey semi-circles at the centre"></div></div><div class="blend-example__col"><img src="../../assets/img/about/lakebled.jpg" alt="Lake bled from above"><div class="blend-example__layer" style="--blend:color-dodge"><img src="../../assets/img/articles/holo/mask-layer.jpg" alt="Black and white concentric circles, with two grey semi-circles at the centre"></div></div></div><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="compositing-layers">Compositing layers<span class="dot">.</span><a href="index.html#compositing-layers" class="u-vhide"> permalink</a></h2><img src="../../assets/img/articles/holo/composite-diagram.jpg" alt="A diagram summarising how layers can be composited together to form a new image"><p>Now we know what we're working with, it might seem like the next step would be to slap a blend mode onto our gradient, place it over our base image and call it a day. That will definitely work, but it won't reach the level of quality we're going for.</p><p>Blending the gradient directly to the base layer will mean that the lighting will be totally uniform across the image. Aside from chromed surfaces, that doesn't happen too often in nature. To really sell the effect we want to have control over the areas of the image where light can fall and where it can't. To simulate this, we can use a predominately dark image to mask out our gradient. This technique of using a dark image to mask off areas of a lighter one is often known as a <em>specular map</em>.</p><p>You might be wondering how it will be possible to do this with CSS if <code>mix-blend-mode</code> only affects the pixels in the layer directly below it, and we can only set one blend mode at a time. This is where our HTML structure starts to shine.</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tower.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Asakusa at dusk<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer specular<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer mask<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span></code></pre><p>By nesting <code>div</code> layers inside of one another, we can work outwards applying additional <code>mix-blend-mode</code>s to each wrapping <code>div</code>. Essentially, this lets us add another <code>mix-blend-mode</code> to the output of the previous blend. This process of layering different blend modes to produce a final output is known as <code>compositing</code>.</p><p>Let's give it a try. Using a suitably dark <code>background-image</code> we'll set <code>mix-blend-mode: multiply</code> on our <code>.mask</code> layer and throw away the parts of our gradient where we don't want light to show through.</p><img src="../../assets/img/articles/holo/composite-diagram-multiply.jpg" alt="Two images are combined with a multiply blend to form a mask"><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">.mask</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> multiply<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(/tower_spec.jpg)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token selector">.specular</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">background-attachment</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>180deg<span class="token punctuation">,</span> black 20%<span class="token punctuation">,</span> #3c5e6d 35%<span class="token punctuation">,</span> #f4310e<span class="token punctuation">,</span> #f58308 80%<span class="token punctuation">,</span> black<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Now that we have our specular map, we can apply the final lighting to the base image. We need to use one of the blend modes that ignores black and dark tones. This means that we should set our <code>.specular</code> layer to use <code>mix-blend-mode: screen</code> or <code>mix-blend-mode: color-dodge</code>. Either would work in this case, but because we want the highlights to blow out into a nice sunlight-bloom effect, we'll go for <code>color-dodge</code>.</p><p>Let's take a look:</p><img src="../../assets/img/articles/holo/composite-diagram-dodge.jpg" alt="two images are combined with color-dodge blend to form a bloom effect"><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token selector">.specular</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> color-dodge<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token property">background-attachment</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>180deg<span class="token punctuation">,</span> black 20%<span class="token punctuation">,</span> #3c5e6d 35%<span class="token punctuation">,</span> #f4310e<span class="token punctuation">,</span> #f58308 80%<span class="token punctuation">,</span> black<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="the-final-shader">The final shader<span class="dot">.</span><a href="index.html#the-final-shader" class="u-vhide"> permalink</a></h2><p>And with that, the effect is complete! Here's the completed HTML and CSS:</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tower.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Asakusa at dusk<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer specular<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shader__layer mask<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span><br><span class="highlight-line"></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css"><br><span class="highlight-line">  <span class="token selector">.shader</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token comment">/* to force GPU performance */</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token selector">.shader__layer</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-size</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-position</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token selector">.specular</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> color-dodge<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-attachment</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>180deg<span class="token punctuation">,</span> black 20%<span class="token punctuation">,</span> #3c5e6d 35%<span class="token punctuation">,</span> #f4310e<span class="token punctuation">,</span> #f58308 80%<span class="token punctuation">,</span> black<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token selector">.mask</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> multiply<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(/tower_spec.jpg)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span></code></pre><p>Let's take another look at the completed effect, but this time with the added ability to isolate each layer of the shader. Change the view mode dropdown to step through the effect and get a better idea of how the layers work together to produce the final image:</p><div class="example"><div class="controls"><label>View mode: <span class="selectbox"><select><option value="off">No effect</option><option value="spec">Specular only</option><option value="specbase">Specular + base image</option><option value="mask">Mask only</option><option value="specmask">Specular + mask</option><option value="" selected="selected">Full effect</option></select></span></label></div><div class="frame frame--asakusa"><div class="shader"><img src="../../assets/img/articles/holo/tower.jpg" alt="Asakusa at dusk"><div class="shader__layer specular"><div class="shader__layer mask"></div></div></div></div></div><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="taking-it-further">Taking it further<span class="dot">.</span><a href="index.html#taking-it-further" class="u-vhide"> permalink</a></h2><p>In the example above, we used a greyscale version of the main image (with added scratches and bokeh) as a mask. That's a great way to add interest to an image, but shader layers can be whatever you want them to be. Let's look at a few more examples.</p><h3 class="t-heading t-lede:s t-subhead:m t-subhead:l" id="aurora-borealis">Aurora Borealis<span class="dot">.</span><a href="index.html#aurora-borealis" class="u-vhide"> permalink</a></h3><p>In this example, repeating the gradient background gradient and reducing <code>background-size-y</code> causes the light efffect to move more quickly across the screen. When masked out with a specular map, this creates the illusion of an aurora rippling over the main image. Blown-out highlights with <code>colour-dodge</code> creates the wrong effect here, so swapping our <code>.specular</code> layer to <code>mix-blend-mode: screen</code> maintains the sharp definition of the aurora.</p><div class="example"><div class="controls"><label>View mode: <span class="selectbox"><select><option value="off">No effect</option><option value="spec">Specular only</option><option value="specbase">Specular + base image</option><option value="mask">Mask only</option><option value="specmask">Specular + mask</option><option value="" selected="selected">Full effect</option></select></span></label></div><div class="frame frame--aurora"><div class="shader"><img src="../../assets/img/articles/holo/forest.jpg" alt="A pine forest at night"><div class="shader__layer specular"><div class="shader__layer mask"></div></div></div></div></div><h3 class="t-heading t-lede:s t-subhead:m t-subhead:l" id="light-leak">Light-leak<span class="dot">.</span><a href="index.html#light-leak" class="u-vhide"> permalink</a></h3><p>Until now the examples have all used a greyscale specular map, but a full colour specular map can introduce new effects. In this example the mask image is created from an inverted and blurred version of the primary image, with a blue-red tone overlaid on top. When it's all layered together with a hot red-orange gradient, the resulting blend of colours results in something that looks a little like the light-leaks you get on vintage film cameras.</p><div class="example"><div class="controls"><label>View mode: <span class="selectbox"><select><option value="off">No effect</option><option value="spec">Specular only</option><option value="specbase">Specular + base image</option><option value="mask">Mask only</option><option value="specmask">Specular + mask</option><option value="" selected="selected">Full effect</option></select></span></label></div><div class="frame frame--leak"><div class="shader"><img src="../../assets/img/articles/holo/pinelake.jpg" alt="A lake with pine trees"><div class="shader__layer specular"><div class="shader__layer mask"></div></div></div></div></div><h3 class="t-heading t-lede:s t-subhead:m t-subhead:l" id="hologram">Hologram<span class="dot">.</span><a href="index.html#hologram" class="u-vhide"> permalink</a></h3><p>Layering within the mask opens up even more possiblilities. What would happen if we add another layer with <code>background-attachment: fixed</code>?</p><p>In this final example the mask layer has a background image SVG, and another black-white gradient running at the opposite angle to the specular gradient in the <code>.specular</code> layer. Setting the nested mask layer to <code>color-burn</code> causes it to blow out the definition of the SVG and you get this sweet two-way holographic look. CSS <em>is</em> awesome.</p><div class="example"><div class="controls"><label>View mode: <span class="selectbox"><select><option value="off">No effect</option><option value="spec">Specular only</option><option value="specbase">Specular + base image</option><option value="mask">Mask only</option><option value="specmask">Specular + mask</option><option value="" selected="selected">Full effect</option></select></span></label></div><div class="frame frame--sticker"><div class="shader"><img src="../../assets/img/articles/holo/dash.jpg" alt="The dashboard of a vintage car"><div class="shader__layer specular"><div class="shader__layer mask"></div></div></div></div></div><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="wrapping-up">Wrapping up<span class="dot">.</span><a href="index.html#wrapping-up" class="u-vhide"> permalink</a></h2><p>I've said it before, but it bears repeating: modern CSS is such an amazing tool to work with and I'm consistently impressed with the level of fidelity you can achieve. That said, It's time to address the potential elephant in the room. Depending on the device or browser you've used to read this article, your scroll performance might be on the floor and your fans may have kicked up a notch.</p><p>At the time of writing, blend modes in browsers are still pretty resource heavy. For more complex effects, with several layers of compositing, you will see a real performance hit. Add any CSS animations or transitions to the mix and it will really tank - particularly in Safari. After a bit of tweaking I eventually managed to claw back a bit of a performance boost by using <code>backface-visibility: hidden</code>, but my initial impulse was to force GPU rendering by using the trusty <code>transform: translateZ(0);</code> hack. Sadly, adding a transform revealed another quirk to be aware of.</p><p>Due to the reliance on <code>background-attachment: fixed</code>, applying CSS transforms to the shader can cause some strange side-effects. In Chrome it broadly works, but the gradients may appear offset depending on the transforms applied. Firefox on the other hand, will simply ignore the fixed positioning and your gradients will totally appear static. I'm sure there are ways and means around that, but they'd likely be testing the spirit of doing all of this without using JS.</p><p>All-in-all this was really fun to explore. Sure, we can't get quite the same level of fidelity as GLSL, but for simpler effects this technique is a great alternative to introducing extra libraries to your project. As great as these effects can look though, I think that for now this is very much a case of: just because you can, doesn't mean you should.</p><p>Until CSS filters and blend modes become more performant (or until browsers allow linking GLSL filters directly from CSS ðŸ¤ž) restraint and subtlety might be the best way to go.</p><h2 class="t-heading t-lede:s t-medium:m t-medium:l" id="image-credits">Image credits<span class="dot">.</span><a href="index.html#image-credits" class="u-vhide"> permalink</a></h2><p>The demos in this article use a collection of images or composited textures made available by the Unsplash photographers below. Please go check out their beautiful work.</p><ul><li><a href="https://unsplash.com/photos/4ShXInrtdV4" target="_blank">Bokeh lights</a> by <a href="https://unsplash.com/@helloimnik" target="_blank">Hello I'm Nik</a></li><li><a href="https://unsplash.com/photos/SkLSOR5r3nc" target="_blank">Silhouette of pine trees under stars</a> by <a href="https://unsplash.com/@joshua_j_woroniecki" target="_blank">Joshua Woroniecki</a></li><li><a href="https://unsplash.com/photos/upXoQv5GAr8" target="_blank">Aurora</a> by <a href="https://unsplash.com/@followhansi" target="_blank">Johannes Groll</a></li><li><a href="https://unsplash.com/photos/P8PlK2nGwqA" target="_blank">Lake under blue sky</a> by <a href="https://unsplash.com/@juanster" target="_blank">Juan Davila</a></li><li><a href="https://unsplash.com/photos/I1C6CrPNyo8" target="_blank">Vintage dashboard</a> by <a href="https://unsplash.com/@ynwasso" target="_blank">Wassim Chouak</a></li><li><a href="https://unsplash.com/photos/2jYK_Bloby4" target="_blank">Light leak</a> by <a href="https://unsplash.com/@seanwsinclair" target="_blank">Sean Sinclair</a></li><li><a href="https://unsplash.com/photos/1k7vrumRHow" target="_blank">Scratches</a> by <a href="https://unsplash.com/@dancristianpaduret" target="_blank">Dan Cristian PÄƒdureÈ›</a></li></ul></div><footer class="article__footer"><div class="author"><div class="author__inr"><div class="author__portrait"><div class="portrait"><span class="portrait__bg dots" data-drift="-10 -10"></span><div class="portrait__image"><span class="duotone"><img src="../../assets/img/portrait_small.jpg"></span></div></div></div><div class="author__bio flow"><h4 class="t-heading t-sublede:s t-lede:m t-medium:l">Hi, my name is Robb<span class="dot">.</span></h4><p>I'm a freelance creative developer helping awesome people to build ambitious yet accessible web projects.</p><a href="mailto:hello@robbowen.digital?subject=ðŸ¤˜ Hi Robb, I'd like to hire you" class="btn author__cta"><span class="btn__label">Hire me</span> <span class="btn__fill stripes" data-drift="-10 -12" aria-hidden="true">Hire me</span></a></div></div></div></footer></div></main><small class="made-in-wales">Â© MMXXIV. Gwneud yn Ne Cymru.</small></div><script src="../../assets/js/main.js"></script><script class="custom-js" src="../../assets/js/articles/shader.js"></script></body></html>